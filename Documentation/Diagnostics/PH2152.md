# PH2152: Order DataRow attribute above TestMethod for unit tests

| Property | Value  |
|--|--|
| Package | [Philips.CodeAnalysis.MsTestAnalyzers](https://www.nuget.org/packages/Philips.CodeAnalysis.MsTestAnalyzers) |
| Diagnostic ID | PH2152 |
| Category  | [MsTest](../MsTest.md) |
| Analyzer | [DataRowOrderAnalyzer](https://github.com/philips-software/roslyn-analyzers/blob/main/Philips.CodeAnalysis.MsTestAnalyzers/DataRowOrderAnalyzer.cs)
| CodeFix  | Yes |
| Severity | Warning |
| Enabled By Default | No |

## Introduction

DataRow attributes should be consistently ordered above TestMethod/DataTestMethod attributes on test methods to improve readability and maintain consistency across the codebase.

## How to solve

Move all DataRow attributes to appear before TestMethod or DataTestMethod attributes on the method.

## Example

Code that triggers a diagnostic:
``` cs
[TestClass]
public class Tests
{
    [TestMethod]
    [DataRow(1, 2)]
    [DataRow(3, 4)]
    public void TestMethod1(int x, int y) 
    { 
        // Test implementation
    }
    
    [DataTestMethod]
    [DataRow("test")]
    public void TestMethod2(string value) 
    { 
        // Test implementation
    }
}
```

And the replacement code:
``` cs
[TestClass]
public class Tests
{
    [DataRow(1, 2)]
    [DataRow(3, 4)]
    [TestMethod]
    public void TestMethod1(int x, int y) 
    { 
        // Test implementation
    }
    
    [DataRow("test")]
    [DataTestMethod]
    public void TestMethod2(string value) 
    { 
        // Test implementation
    }
}
```

## Configuration

This analyzer does not offer any special configuration. The general ways of [suppressing](https://learn.microsoft.com/en-us/dotnet/fundamentals/code-analysis/suppress-warnings) diagnostics apply.