# PH2160: Use combinatorial testing

| Property | Value  |
|--|--|
| Package | [Philips.CodeAnalysis.MsTestAnalyzers](https://www.nuget.org/packages/Philips.CodeAnalysis.MsTestAnalyzers) |
| Diagnostic ID | PH2160 |
| Category  | [MsTest](../MsTest.md) |
| Analyzer | [PreferCombinatorialTestingAnalyzer](https://github.com/philips-software/roslyn-analyzers/blob/main/Philips.CodeAnalysis.MsTestAnalyzers/PreferCombinatorialTestingAnalyzer.cs)
| CodeFix  | No |
| Severity | Info |
| Enabled By Default | No |

## Introduction

Test methods with a single parameter and multiple DataRow attributes can be simplified using CombinatorialValues from the `Combinatorial.MSTest` package. This makes the test more maintainable and concise when you have many values to test for a single parameter.

## How to solve

Consider refactoring your test method to use CombinatorialValues with the `Combinatorial.MSTest` package. This is particularly beneficial for single-parameter methods with many different test values.

First, install the Combinatorial.MSTest package:
```xml
<PackageReference Include="Combinatorial.MSTest" Version="1.0.11" />
```

Then refactor your test to use `CombinatorialValues` attribute on the parameter.

## Example

Code that triggers a diagnostic:
``` cs
[TestMethod]
[DataRow("private")]
[DataRow("public")]
[DataRow("internal")]
[DataRow("protected")]
[DataRow("static")]
[DataRow("readonly")]
[DataRow("const")]
[TestCategory(TestDefinitions.UnitTests)]
public void TestMethodWithManyDataRows(string modifier)
{
    // Test implementation
}
```

Refactored code using CombinatorialValues:
``` cs
[TestMethod]
[TestCategory(TestDefinitions.UnitTests)]
public void TestMethodWithCombinatorialValues(
    [CombinatorialValues("private", "public", "internal", "protected", "static", "readonly", "const")] string modifier)
{
    // Test implementation
}
```

## Configuration

This analyzer is disabled by default. To enable it, add the following to your .editorconfig:

```ini
dotnet_diagnostic.PH2160.severity = suggestion
```

The analyzer triggers when:
- A test method has exactly 1 parameter
- The method has 4 or more DataRow attributes  
- All DataRow attributes have exactly 1 argument each

The general ways of [suppressing](https://learn.microsoft.com/en-us/dotnet/fundamentals/code-analysis/suppress-warnings) diagnostics apply.